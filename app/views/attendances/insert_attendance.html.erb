<script>

$(document).ready(function() {
$('#maintable').dataTable();
})

</script>


<div class="panel panel-primary">
	<div class="panel-heading">
		<h3 class="panel-title">Insert Attendance From</h3>
	</div>
	<div class="panel-body">
		<div class="container">
			<body>
				<div>
					<% @currentgroup = Group.find_by_id(params[:id])%>
					
					<%= form_tag(process_insert_attendance_path(@currentgroup.id)) do%>
					<div>
						<%= label_tag "Select user" %>
						<br>
						<i> ~User only from this group are shown</i>
						<br>
						<%= select_tag(:user_ids, options_for_select(users_in_group_unfiltered(@currentgroup).collect {|u| [(u.fname+" "+u.lname), u.id]}),{data:{live_search: "true"},:class => 'form-control', :multiple => true, :name=>'project[user_ids][]'}) %>
					</div>
					<div>
						<%= label_tag 'Select event'%>
						<br>
						
						<%= select_tag :event, options_for_select(assigned_events(@currentgroup.id).collect {|e| [e.event_name, e.id]}), :class => 'form-control', :id => 'event'%>
					</div>
					
					<div>
						<%= label_tag 'Select offence'%>
						<br>
						
						<%= select_tag :offence, options_for_select([["Absent"],["Tardy"],["Tardy limit absence"]]), :class => 'form-control', :id => 'event'%>
					</div>

					<div>
						<%= label_tag "Select date" %>
						<br>
						<i> ~Use the date picker(Click on the field. If you have problems try to click anywhere on the page then click the field again) to select which date you want to mark user as absent. Note: You cannot type dates in, but you can use picker.</i>
						<br>
						<%= text_field_tag "date", nil, {:class => 'form-control', :id => 'date', :readonly => true}%>
					</div>
					<br>
					<div class="actions">
						<%= submit_tag 'Submit', data: {confirm: 'Please review your selections hence your changes are permanent. Press cancel if you wish to make a change, otherwise press OK', toggle: "modal", target: '#myModal'  }, :class=>'btn btn-primary' %>
						<%= link_to 'Adjust Attendance', attendances_path(:attgroup_id => @currentgroup.id), :class => 'btn btn-default' %>
					</div>
					<% end %>
				</div>
			</body>
		</div>
	</div>
</div>

<!-- Loading Modal -->
<div class="modal fade" id="myModal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title" id="myModalLabel">Updating records and notifying users... Please wait.</h4>
			</div>
			<div class="modal-body">
				<div class="progress">
					<div class="progress-bar progress-bar-striped active"  role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
				</div>
			</div>
		</div>
	</div>
</div>
<script>
	$(document).ready(function() {
		$('#date').datetimepicker({
			pickTime : false
		});
	}); 
</script>
<script>
	$(document).ready(function() {
		$('select').selectpicker();
	}); 
</script>